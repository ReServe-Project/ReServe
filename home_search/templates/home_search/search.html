{% extends 'base.html' %} 
{% load static humanize %}

{% block title %}ReServe - Our Classes{% endblock %}

{% block content %}

{# HERO: full-bleed, centered title #}
<section class="relative isolate -mt-px w-screen left-1/2 right-1/2 -ml-[50vw] -mr-[50vw]">
  <img src="{% static 'img/hero-classes.png' %}"
       alt=""
       class="block w-full h-[220px] md:h-[260px] lg:h-[300px] object-cover object-center">
  <h1 class="absolute inset-0 flex items-center justify-center
             text-white font-extrabold text-4xl md:text-5xl lg:text-6xl
             drop-shadow-[0_3px_6px_rgba(0,0,0,0.3)]">
    Our Classes
  </h1>
</section>

{# --- CATEGORY CHIPS: sits between hero and panel --- #}
<div class="relative z-30 -mt-8 md:-mt-12 lg:-mt-14 mb-4 flex justify-center">
  <div
    class="inline-flex items-center gap-4 px-6 py-3
           bg-white rounded-[999px]
           shadow-[0_14px_28px_rgba(0,0,0,0.08)]
           border border-black/5"
  >
    {# All Classes chip #}
    <a href="{% url 'home_search:search' %}"
       class="px-6 py-2 rounded-full font-semibold tracking-tight
              {% if not active_category %}
                bg-[#6B3925] text-white
              {% else %}
                bg-[#FFF3E2] text-[#6B3925] border-2 border-[#6B3925] hover:bg-[#FBE9D6]
              {% endif %}">
      All Classes
    </a>

    <span aria-hidden="true" class="hidden sm:block h-8 w-[3px] bg-[#57544F] rounded-full"></span>

    {# Category chips (only one active) #}
    {% for key,label in categories %}
      {% if key == active_category %}
        <a href="{% url 'home_search:search' %}?category={{ key }}"
           class="px-6 py-2 rounded-full font-semibold tracking-tight
                  bg-[#6B3925] text-white">
          {{ label }}
        </a>
      {% else %}
        <a href="{% url 'home_search:search' %}?category={{ key }}"
           class="px-6 py-2 rounded-full font-semibold tracking-tight
                  bg-[#FFF3E2] text-[#6B3925] border-2 border-[#6B3925] hover:bg-[#FBE9D6]">
          {{ label }}
        </a>
      {% endif %}
    {% endfor %}
  </div>
</div>

{# Create Class button (UNDER chips) â€” only for instructors #}
{% if show_create_button %}
  <div class="relative z-50 mt-4 flex justify-center pointer-events-none">
    <a href="{% url 'home_search:class_create' %}"
       class="inline-flex items-center px-5 py-2 rounded-full bg-[#603A22] text-white font-semibold shadow pointer-events-auto">
      + Create Class
    </a>
  </div>
{% endif %}

{# PANEL: full width, rounded top, cards with bottom-aligned buttons #}
{% static 'img/class-placeholder.jpg' as CLASS_PLACEHOLDER %}

<section class="relative z-[1] -mt-6">
  <div class="relative w-screen left-1/2 -ml-[50vw]">
    <div class="bg-transparent
                rounded-t-[36px] md:rounded-t-[44px] lg:rounded-t-[56px]
                overflow-hidden">
      <div class="max-w-7xl mx-auto px-6 md:px-12 py-10">

        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 items-stretch auto-rows-fr">
          {% for c in classes %}
            <article class="bg-white rounded-2xl border border-black/10 shadow-md p-3 h-full flex flex-col">
              <div class="relative aspect-[4/3] overflow-hidden rounded-xl">
                <img src="{% firstof c.image_url CLASS_PLACEHOLDER %}"
                     alt="{{ c.name }}"
                     class="absolute inset-0 w-full h-full object-cover">
              </div>

              <div class="px-2 pt-3 pb-2">
                <h3 class="text-lg font-extrabold text-[#1B1C22] leading-tight">
                  {{ c.name }}
                </h3>
                <p class="text-sm text-[#575757] mt-1">Rp {{ c.price|intcomma }}</p>
              </div>

              {% if request.user.is_authenticated and c.owner_id == request.user.id %}
                {# Owner view: Delete / Edit / Details #}
                <div class="px-2 pb-2 grid grid-cols-3 gap-2 mt-auto">
                  <form action="{% url 'home_search:class_delete' pk=c.pk %}" method="post"
                        onsubmit="return confirm('Delete this class?')">
                    {% csrf_token %}
                    <button class="w-full px-3 py-2 rounded-lg bg-[#E6554A] text-white text-sm font-semibold">
                      Delete
                    </button>
                  </form>

                  <a href="{% url 'home_search:class_edit' pk=c.pk %}"
                     class="w-full text-center px-3 py-2 rounded-lg bg-[#2F6FED] text-white text-sm font-semibold">
                    Edit
                  </a>

                  <a href="{% url 'home_search:class_detail' pk=c.pk %}"
                     class="w-full text-center px-3 py-2 rounded-lg bg-[#E98049] text-white text-sm font-semibold">
                    Details
                  </a>
                </div>
              {% else %}
                {# Non-owner (incl. members): Details only #}
                <div class="px-2 pb-2 mt-auto">
                  <a href="{% url 'home_search:class_detail' pk=c.pk %}"
                     class="block w-full text-center px-5 py-2.5 rounded-xl bg-[#E98049] text-white font-semibold shadow hover:brightness-110">
                    Details
                  </a>
                </div>
              {% endif %}
            </article>
          {% empty %}
            <p class="col-span-4 text-center text-gray-500">No classes found.</p>
          {% endfor %}
        </div>

      </div>
    </div>
  </div>
</section>

{% endblock %}



